/* This Source Code Form is subject to the terms of the Mozilla Public
*  License, v. 2.0. If a copy of the MPL was not distributed with this file,
*  You can obtain one at http://mozilla.org/MPL/2.0/.  */
!function(a,b){"use strict";function c(a){if(Object.create)return Object.create(a);var b=function(){};return b.prototype=a,new b}function d(){return(new Date).getTime()}function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})}var f,g="__speed_trap__",h={init:function(a){a=a||{},this.navigationTiming=c(k),this.navigationTiming.init(a),this.timers=c(l),this.timers.init(),this.events=c(m),this.events.init(),this.stored=c(n),this.uuid=e()},get:function(){return{uuid:this.uuid,navigationTiming:this.navigationTiming.get(),timers:this.timers.get(),events:this.events.get()}},store:function(){this.stored.store(this.get())}},i={navigationStart:b,unloadEventStart:b,unloadEventEnd:b,redirectStart:b,redirectEnd:b,fetchStart:b,domainLookupStart:b,domainLookupEnd:b,connectStart:b,connectEnd:b,secureConnectionStart:b,requestStart:b,responseStart:b,responseEnd:b,domLoading:b,domInteractive:b,domContentLoadedEventStart:b,domContentLoadedEventEnd:b,domComplete:b,loadEventStart:b,loadEventEnd:b};try{f=window.performance.timing}catch(j){f=c(i)}var k={init:function(a){a=a||{},this.navigationTiming=a.navigationTiming||f},get:function(){return this.navigationTiming}},l={init:function(){this.completed={},this.running={}},start:function(a){var b=d();if(this.running[a])throw new Error(a+" timer already started");this.running[a]=b},stop:function(a){var b=d();if(!this.running[a])throw new Error(a+" timer not started");this.completed[a]||(this.completed[a]=[]);var c=this.running[a];this.completed[a].push({start:c,stop:b,elapsed:b-c}),this.running[a]=null,delete this.running[a]},get:function(a){return a?this.completed[a]:this.completed}},m={init:function(){this.events=[]},capture:function(a){this.events.push({type:a,timestamp:d()})},get:function(){return this.events}},n={store:function(a){var b=this.get(),c=b[b.length-1];c&&c.uuid===a.uuid&&b.pop(),b.push(a),localStorage.setItem(g,JSON.stringify(b))},get:function(){var a=localStorage.getItem(g)||"[]",b=JSON.parse(a);return b},clear:function(){localStorage.removeItem(g)}};a.SpeedTrap=c(h),a.SpeedTrap.init()}(this);